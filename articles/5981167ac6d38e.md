---
title: "Vue.js ã¨ google.script.run ã¯å™›ã¿åˆã‚ã›ãŒæ‚ªã„"
emoji: "ğŸ™"
type: "tech"
topics: ["googleappsscript","vue"]
published: true
---

# å•é¡Œç‚¹
`google.script.run`ã§å–å¾—ã—ãŸå€¤ã‚’ãã®ã¾ã¾`Vue`ã«æ¸¡ã™ã¨åŒæ–¹å‘ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒåŠ¹ãã¾ã›ã‚“ã€‚

```Javascript:xxx.js
const userData = await new Promise( resolve => {
  google.script.run
  .withSuccessHandler( resolve )
  .getUserData()
} )

const app = new Vue( {
  data: { userData, },
} )
```

```html:xxx.html
<!-- ç”»é¢ä¸Šã§æ“ä½œã—ã¦ã‚‚userData.fooã®å€¤ãŒå¤‰åŒ–ã—ã¦ãã‚Œãªã„ -->
<p><input v-model="userData.foo" /></p>
```

# ç†ç”±
æ¨æ¸¬ã§ã™ãŒã€`google.script.run`ãŒå®Ÿè¡Œã•ã‚Œã‚‹ç”»é¢ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰ãŒã‚¢ãƒ—ãƒªã®ç”»é¢ã¨ç•°ãªã‚‹ãŸã‚ã ã¨æ€ã‚ã‚Œã¾ã™ã€‚

[ä»¥å‰ã®è¨˜äº‹](https://zenn.dev/37cohina/articles/710771a99b61e1)ã§è§¦ã‚ŒãŸé€šã‚Š GAS ã® Webã‚¢ãƒ—ãƒªã¯`iframe`ãŒ2é‡ã«ãƒã‚¹ãƒˆã•ã‚Œã¦ãŠã‚Šã€`google.script.run`ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ã®ã¯1ã¤ã‚ã®`iframe`ã€ã“ã¡ã‚‰ã®æ›¸ã„ãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯2ã¤ã®`iframe`ã«ç½®ã‹ã‚Œã‚‹ãŸã‚ã€åŒã˜`Object`å‹ã§ã‚‚ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒåˆ¥ã«ãªã‚Šã¾ã™ã€‚

`Vue.js`ã®æ–¹ã¯é–¢ä¿‚ã™ã‚‹å‡¦ç†ã¯è¦‹ã¤ã‘ã‚‰ã‚Œãªã‹ã£ãŸã®ã§ã™ãŒã€æã‚‰ã`prototype`ã«ä¾å­˜ã™ã‚‹å‡¦ç†ãŒã‚ã‚‹ã®ã ã¨æ€ã„ã¾ã™ã€‚

ã¡ãªã¿ã«`{{ value }}`ã§è¡¨ç¤ºã•ã›ã‚‹ç®‡æ‰€ã‚‚æ­£å¸¸ã«å‹•ä½œã›ãšã€`[object Object]`ã®ã‚ˆã†ãªç”Ÿã® Javascript ã®è¡¨ç¤ºã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚
ã“ã¡ã‚‰ã¯`Vue.js`ã§è©²å½“ç®‡æ‰€ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸã®ã§æŠœç²‹ã—ã¾ã™ã€‚
ã“ã‚Œã‚’è¦‹ã‚‹é™ã‚Š`toString`ãŒ`Object.prototype.toString`ã¨å‚ç…§ä¸€è‡´ã—ã¦ã„ãªã„ã¨JSONåŒ–ã—ã¦ã‚‚ã‚‰ãˆãªã„ã‚ˆã†ã§ã™ã€‚

```Javascript:Vue.jsã‚ˆã‚ŠæŠœç²‹
  /**
   * Get the raw type string of a value, e.g., [object Object].
   */
  var _toString = Object.prototype.toString;

//ä¸­ç•¥

  /**
   * Convert a value to a string that is actually rendered.
   */
  function toString (val) {
    return val == null
      ? ''
      : Array.isArray(val) || (isPlainObject(val) && val.toString === _toString)
        ? JSON.stringify(val, null, 2)
        : String(val)
  }
```

# è§£æ±ºç­–
æœ€åˆã¯`Object.assign`ã‚’ä½¿ãŠã†ã‹ã¨æ€ã£ãŸã®ã§ã™ãŒã€é…åˆ—ã‚„`null`ã¨ä»–ã®åŸºæœ¬ãƒ‡ãƒ¼ã‚¿å‹ã‚’åˆ†ã‘ãŸã‚Šå†å¸°çš„ã«å‡¦ç†ã—ãŸã‚Šã¨å‡ã£ãŸå†…å®¹ã«ãªã£ã¦ã—ã¾ã†ã®ã§ã€ç°¡æ½”ã«JSONåŒ–ã—ã¦ã™ããƒ‘ãƒ¼ã‚¹ã™ã‚‹æ–¹æ³•ã‚’å–ã‚Šã¾ã—ãŸã€‚

```Javascript:xxx.js
const userData = await new Promise( resolve => {
  google.script.run
  .withSuccessHandler( v => resolve( JSON.parse( JSON.stringify( v ) ) ) )
  .getUserData()
} )

const app = new Vue( {
  data: { userData, },
} )
```

ä»¥ä¸Šï¼
Google Apps Script ã§ã® Web ã‚¢ãƒ—ãƒªé–‹ç™ºã¯å°‘ã—ç™–ãŒã‚ã‚‹æ„Ÿã˜ãŒã‚ã‚Šã¾ã™ã­ã€‚
